# 访问者模式

## 什么是访问者模式

> Represent  an  operation to be  performed  on the  elements  of  an  object structure.  Visitor lets  you  define  a  new  operation  without  changing  the  classes  of  the  elements  on witch  it operates.
>
> 封装一些将要操作在数据结构元素上的操作. 访问者模式能让你在不改变对象元素结构的前提下, 定义一个新的操作.

访问模式的核心思想在于: `可以在并不改变数据结构的前提下定义作用域这些元素的新操作. 将数据结构和操作(或算法)进行解耦,而且能够更方便的拓展新的操作.`

![](./image/designpattern/visitor.png)

## 优缺点

> 优点
>
> 1. 将数据结构和操作(算法)进行分离, 降低了耦合性.  将有关元素对象的访问行为集合到一个访问者对象中, 而不是分散在一个个的元素类中, 类的职责更加清晰
> 2. 增加新的访问操作很方便. 使用访问模式, 增加新的访问操作就意味着增加一个新的具体访问者类,实现简单, 无需修改源代码.
> 3. 让用户能够在不修改现有元素类层次结构的情况下, 定义作用于该层次结构的操作

> 缺点
>
> 1. 增加新的元素类比较困难.在访问模式中, 每增加一个新的元素类都意味着要在抽象访问者角色中增加一个新的抽象操作, 并在每一个具体访问者类中增加相应的具体操作, 不符合"开闭原则".
> 2. 破坏数据对象的封装性. 访问模式要求访问者对象能够访问并调用每一个元素的操作细节, 这意味着元素对象必须暴漏一些自己的内部操作和内部状态.

> 应用场景
>
> 1. 对象结构中包含的对象类型比较少, 而且这些类需求比较稳定, 很少改变, 但经常需要在此对象结构上定义新的操作
> 2. 一个对象结构包含多个类型的对象, 希望对这些对象实施一些依赖其具体类型的操作. 在访问模式中针对每一种具体的类型都提供了一个访问操作, 不同类型对象可以有不同的访问操作
> 3. 需要对一个对象请求结构中的对象进行很多不同的并且不相关的对象, 需要避免让这些操作"污染"这些对象的类, 也不希望在增加新操作时修改这些类. 访问模式使得我们可以将相关的访问操作集中起来定义在访问者类中,  对象结构可以被多个不同的访问者类所使用, 将对象本身与对象的访问操作分离.







































